{% extends 'base.html' %}
{% block content %}
<div class="container mt-5 animate__animated animate__fadeIn">
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <h1 class="display-4 mb-4 text-center animate__animated animate__backInDown">{{ budget.budget_name }} Incomes</h1>

            <!-- Button to Add New Income -->
            <div class="mb-4 text-center">
                <a href="{% url 'create_income' budget.id %}" class="btn btn-primary animate__animated animate__jello animate__delay-1s">+ Add New Income</a>
            </div>

            <!-- List of Incomes -->
            {% if incomes %}
            <div class="list-group animate__animated animate__fadeInUp animate__delay-2s">
                {% for income in incomes %}
                <div class="list-group-item d-flex justify-content-between align-items-center animate__animated animate__zoomIn">
                    <span>{{ income.name }}</span>
                    <span class="badge bg-primary rounded-pill">${{ income.amount }}</span>

                    <!-- Button to View Income Details -->
                    <a href="{% url 'income_detail' budget.id income.id %}" class="btn btn-info btn-sm ml-2">Details</a>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="alert alert-info animate__animated animate__fadeIn animate__delay-2s">
                No incomes found for this budget. Add one now!
            </div>
            {% endif %}

            <!-- Summary -->
            <div class="mt-5 p-4 bg-light border animate__animated animate__fadeInRight animate__delay-3s">
                <h5 class="mb-3">Summary</h5>
                <p><strong>Total Incomes:</strong> {{ income_count }}</p>
                <p><strong>Total Income Amount:</strong> ${{ total_income }}</p>
            </div>

        </div>
    </div>
</div>

<script>
  // Bootstrap validation script
  (function () {
    "use strict";
    var forms = document.querySelectorAll(".needs-validation");

    Array.from(forms).forEach(function (form) {
      form.addEventListener(
        "submit",
        function (event) {
          if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
          }
          form.classList.add("was-validated");
        },
        false
      );
    });
  })();
</script>
{% endblock %}
